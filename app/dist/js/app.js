!function(e){function n(e){e.when("/etiquetas",{controller:"etiquetasController",controllerAs:"ctrl",templateUrl:"etiquetas/choose_idioma.html"}).when("/etiquetas/:lang",{controller:"etiquetasController",controllerAs:"ctrl",templateUrl:"etiquetas/etiquetas.html"})}e.module("app.etiquetas",["ngRoute"]).config(n),n.$inject=["$routeProvider"]}(window.angular),function(e){function n(e){e.when("/idiomas",{controller:"idiomaController",controllerAs:"ctrl",templateUrl:"idiomas/idiomas.html",title:"Idiomas"})}e.module("app.idiomas",["ngRoute"]).config(n),n.$inject=["$routeProvider"]}(window.angular),function(e){e.module("app.settings",["ngRoute"]).config(["$routeProvider",function(e){e.when("/settings",{controller:"settingsController",controllerAs:"ctrl",templateUrl:"settings/settings.html",title:"Configuración"})}])}(window.angular),function(e){function n(e,n){function o(o){var r=e.defer();return n.readSettings().then(function(e){var n=i.join(e.localLang,o,"lang.json");t.readFile(n,"utf8",function(e,n){e&&r.reject(e);try{var t=JSON.parse(n.trim());r.resolve(t)}catch(e){r.reject(e)}})}),r.promise}return{getLangTags:o}}e.module("app.etiquetas").service("etiquetasService",n);var t=require("fs"),i=require("path");n.$inject=["$q","configService"]}(window.angular),function(e){function n(e,n){function r(){var r=n.defer();return e.readSettings().then(function(e){var n=i.join(e.localLang,o);t.readFile(n,"utf8",function(e,n){e&&r.reject(e);try{var t=JSON.parse(n.trim());r.resolve(t)}catch(e){r.reject(e)}})}),r.promise}function a(a){var c=n.defer();return e.readSettings().then(function(e){var n=i.join(e.localLang,o),l=i.join(e.localLang,a.id),s=i.join(l,"lang.json");r().then(function(e){u(e,a.id)?c.reject({code:"EXTLANG",description:"Este idioma ya existe"}):t.mkdir(l,function(i){i&&c.reject(i),t.writeFile(s,"{}","utf8",function(i){i&&c.reject(i),e.push(a);var o=JSON.stringify(e);t.writeFile(n,o,"utf8",function(e){e&&c.reject(e),c.resolve(!0)})})})})}),c.promise}function c(a){var c=n.defer();return e.readSettings().then(function(e){var n=i.join(e.localLang,o),u=i.join(e.localLang,a.id);r().then(function(e){var o=l(e,a.id);t.readdir(u,function(e,r){e&&c.reject(e),r.forEach(function(e){var n=i.join(u,e);t.unlinkSync(n)}),t.rmdir(u,function(e){e&&c.reject(e);var i=JSON.stringify(o);t.writeFile(n,i,"utf8",function(e){e&&c.reject(e),c.resolve(!0)})})})})}),c.promise}function u(e,n){if(e instanceof Array){var t=e.filter(function(e){return e.id==n});return t.length>0}throw"not an array"}function l(e,n){return e.filter(function(e){return e.id!=n})}return{getInstaledLanguages:r,saveLanguage:a,deleteLanguage:c}}var t=require("fs"),i=require("path");const o="languages.json";e.module("app.idiomas").service("idiomasService",n),n.$inject=["configService","$q"]}(window.angular),function(e){"use strict";function n(e){function n(n){var o=e.defer();return t.writeFile(i,JSON.stringify(n),function(e){e&&o.reject(e),o.resolve(!0)}),o.promise}function o(){var n=e.defer();return t.exists(i,function(e){e?t.readFile(i,"utf8",function(e,t){e&&n.reject(e),n.resolve(JSON.parse(t.trim()))}):r().then(function(){return o()})}),n.promise}function r(){var n=e.defer();return t.writeFile(i,"{}","utf8",function(e){e&&n.reject(e),n.resolve(!0)}),n.promise}return{saveSettings:n,readSettings:o}}var t=require("fs"),i="./config.json";e.module("app.config",[]).service("configService",n),n.$inject=["$q"]}(window.angular),function(e){function n(e){function n(e){}return{alert:n}}e.module("app.utils",[]).service("utilsService",n),n.$inject=["$mdDialog"]}(window.angular),function(e){"use strict";function n(e){function n(n){return e.saveSettings(n)}function t(){return e.readSettings()}return{saveSettings:n,readSettings:t}}require("fs");e.module("app.settings").service("settingsService",n),n.$inject=["configService"]}(window.angular),function(e){function n(e,n,t,i,o){function r(e){console.log(e),n.path("/etiquetas/"+e.id)}function a(e){o.getLangTags(e).then(function(e){c.tags=e})}var c=this;c.open=r,i.lang?a(i.lang):t.getInstaledLanguages().then(function(e){c.idiomas=e})}e.module("app.etiquetas").controller("etiquetasController",n),n.$inject=["$scope","$location","idiomasService","$routeParams","etiquetasService"]}(window.angular),function(e){function n(n,t,i,o){function r(){o.getInstaledLanguages().then(function(e){n.idiomas=[].concat(e)})}function a(n){l.idioma={},t.show({title:"Agregar Idioma",controller:u,controllerAs:"ctrl",templateUrl:"idiomas/add-idioma.html",parent:e.element(document.body),targetEvent:n,clickOutsideToClose:!0})}function c(n,i){function r(){function r(){var i=t.alert().title("Proceso Completado").textContent("El idioma ha sido eleminado con exito!").parent(e.element(document.body)).ariaLabel("confirmation").ok("Aceptar").targetEvent(n);l.getInstaledLanguages(),t.show(i)}function a(i){var o=t.alert().title("Algo no anda bien").textContent("Hubo un error eliminando el idioma seleccionado, "+i).parent(e.element(document.body)).ariaLabel("confirmation").ok("Aceptar").targetEvent(n);t.show(o)}o.deleteLanguage(i).then(r,a)}var a=t.confirm().title("Desea Eliminar el idioma seleccionado?").textContent("Este proceso eliminara el idioma seleccionado asi como cualquier etiqueta creada").ok("Eliminar").parent(e.element(document.body)).ariaLabel("confirmation").cancel("Cancelar").targetEvent(n);t.show(a).then(r)}function u(){function e(e){i(function(){function e(e){o.getInstaledLanguages().then(function(e){n.idiomas=[].concat(e)}),r()}function t(e){a.idioma.error=!0}console.log(a);var i={id:a.idioma.id.toLowerCase(),description:a.idioma.description.toUpperCase()};o.saveLanguage(i).then(e,t)})}function r(){t.cancel()}var a=this;a.addIdioma=e,a.closeAddDialog=r}var l=this;l.openAddIdioma=a,l.getInstaledLanguages=r,l.delete=c,l.getInstaledLanguages()}e.module("app.idiomas").controller("idiomaController",n),n.$inject=["$scope","$mdDialog","$timeout","idiomasService"]}(angular),function(e){function n(e,n,t,i){function o(e){t.saveSettings(l.form).then(function(n){var t=i.alert();t.textContent("Cambios Guardados con Exito!").title("Alerta!").targetEvent(e).ok("Aceptar"),i.show(t)})}function r(){t.readSettings().then(function(e){l.form=e})}function a(){u(function(e,n,t){l.form.localLang=n[0]})}function c(){u(function(e,n,t){l.form.remoteLang=n[0]})}function u(e){var t=require("electron").ipcRenderer;t.send("open-file-dialog"),t.once("selected-directory",function(t,i){n(e(t,i))})}var l=this;l.form={},l.chooseLocalLang=a,l.chooseRemoteLang=c,l.saveSettings=o,l.readSettings=r,l.readSettings()}e.module("app.settings").controller("settingsController",n),n.$inject=["$scope","$timeout","settingsService","$mdDialog"]}(window.angular),function(e){function n(e){e.$on("$routeChangeStart",function(n,t,i){e.currentTitle=t.$$route.title})}function t(e,n,t){function i(){n("menuLeft").close()}e.toggleMenu=function(){n("menuLeft").toggle()},e.open=function(e){t.path(e),i()},e.menu={main:[{icon:"language",menuText:"Idiomas",url:"/idiomas"},{icon:"code",menuText:"Etiquetas",url:"/etiquetas"}],settings:[{icon:"settings",menuText:"Configuración",url:"/settings"}]}}var i=["templates","app.config","app.settings","app.idiomas","app.etiquetas","ngMessages","ngMaterial","ngAnimate"];e.module("lang-tag-manager",i).run(n).controller("mainController",t),n.$inject=["$rootScope"],t.$inject=["$scope","$mdSidenav","$location"]}(window.angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV0aXF1ZXRhcy9ldGlxdWV0YXMucm91dGVzLmpzIiwiaWRpb21hcy9pZGlvbWFzLnJvdXRlcy5qcyIsInNldHRpbmdzL3NldHRpbmdzLnJvdXRlcy5qcyIsImV0aXF1ZXRhcy9ldGlxdWV0YXMuc2VydmljZS5qcyIsImlkaW9tYXMvaWRpb21hcy5zZXJ2aWNlLmpzIiwidXRpbHMvY29uZmlnLnNlcnZpY2UuanMiLCJ1dGlscy91dGlscy5zZXJ2aWNlLmpzIiwic2V0dGluZ3Mvc2V0dGluZ3Muc2VydmljZS5qcyIsImV0aXF1ZXRhcy9ldGlxdWV0YXMuY29udHJvbGxlci5qcyIsImlkaW9tYXMvaWRpb21hcy5jb250cm9sbGVyLmpzIiwic2V0dGluZ3Mvc2V0dGluZ3MuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwiY29uZmlnRm4iLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwidGVtcGxhdGVVcmwiLCJtb2R1bGUiLCJjb25maWciLCIkaW5qZWN0Iiwid2luZG93IiwidGl0bGUiLCJldGlxdWV0YXNTZXJ2aWNlIiwiJHEiLCJjb25maWdTZXJ2aWNlIiwiZ2V0TGFuZ1RhZ3MiLCJpZCIsImRlZmVyZWQiLCJkZWZlciIsInJlYWRTZXR0aW5ncyIsInRoZW4iLCJzZXR0aW5ncyIsImxhbmdGaWxlIiwicGF0aCIsImpvaW4iLCJsb2NhbExhbmciLCJmcyIsInJlYWRGaWxlIiwiZXJyIiwiY29udGVudCIsInJlamVjdCIsImxhbmdKc29uIiwiSlNPTiIsInBhcnNlIiwidHJpbSIsInJlc29sdmUiLCJlIiwicHJvbWlzZSIsInNlcnZpY2UiLCJyZXF1aXJlIiwiaWRpb21hc1NlcnZpY2UiLCJnZXRJbnN0YWxlZExhbmd1YWdlcyIsImxvY2FsRmlsZSIsImxhbmd1YWdlc0ZpbGUiLCJkYXRhIiwibGFuZyIsInNhdmVMYW5ndWFnZSIsImxhbmdGb2xkZXIiLCJuZXdMYW5nRmlsZSIsImxhbmd1YWdlcyIsIl9fbGFuZ0V4aXN0cyIsImNvZGUiLCJkZXNjcmlwdGlvbiIsIm1rZGlyIiwid3JpdGVGaWxlIiwicHVzaCIsImxhbmd1YWdlc1N0ciIsInN0cmluZ2lmeSIsImRlbGV0ZUxhbmd1YWdlIiwibmV3TGFuZ3VhZ2VzIiwiX19yZW1vdmVsYW5ndWFnZSIsInJlYWRkaXIiLCJmaWxlcyIsImZvckVhY2giLCJmaWxlIiwiZmlsZVRvRGVsZXRlIiwidW5saW5rU3luYyIsInJtZGlyIiwianNvbkxhbmd1YWdlcyIsIkFycmF5IiwiZWxlbWVudCIsImZpbHRlciIsImxlbmd0aCIsInNldHRpbmdzU2VydmljZSIsInNhdmVTZXR0aW5ncyIsImNvbmZpZ0ZpbGUiLCJleGlzdHMiLCJjcmVhdGVDb25maWciLCJ1dGlsc1NlcnZpY2UiLCIkbWREaWFsb2ciLCJhbGVydCIsIm1zZyIsImV0aXF1ZXRhc0NvbnRyb2xsZXIiLCIkc2NvcGUiLCIkbG9jYXRpb24iLCIkcm91dGVQYXJhbXMiLCJvcGVuRXRpcXVldGFzIiwiY29uc29sZSIsImxvZyIsImxhbmdJZCIsInRhZ3MiLCJzZWxmIiwidGhpcyIsIm9wZW4iLCJpZGlvbWFzIiwiaWRpb21hQ29udHJvbGxlciIsIiR0aW1lb3V0IiwiY29uY2F0Iiwib3BlbkFkZElkaW9tYSIsImV2IiwiaWRpb21hIiwic2hvdyIsImRpYWxvZ0NvbnRyb2xsZXIiLCJwYXJlbnQiLCJkb2N1bWVudCIsImJvZHkiLCJ0YXJnZXRFdmVudCIsImNsaWNrT3V0c2lkZVRvQ2xvc2UiLCIkZXZlbnQiLCJpZlllcyIsInN1Y2Nlc3MiLCJ0ZXh0Q29udGVudCIsImFyaWFMYWJlbCIsIm9rIiwiZXJyb3IiLCJjb25maXJtIiwiY2FuY2VsIiwiYWRkSWRpb21hIiwiY3RybCIsInJlc3VsdCIsImNsb3NlQWRkRGlhbG9nIiwidG9Mb3dlckNhc2UiLCJ0b1VwcGVyQ2FzZSIsImRlbGV0ZSIsInNldHRpbmdzQ29udHJvbGxlciIsInNlbmRlciIsImZvcm0iLCJjaG9vc2VMb2NhbExhbmciLCJvcGVuRGlhbG9nIiwiZXZlbnQiLCJwcm9jIiwiY2hvb3NlUmVtb3RlTGFuZyIsInJlbW90ZUxhbmciLCJjYWxsYmFjayIsImlwY1JlbmRlcmVyIiwic2VuZCIsIm9uY2UiLCJydW5GbiIsIiRyb290U2NvcGUiLCIkb24iLCJuZXh0IiwicHJldiIsImN1cnJlbnRUaXRsZSIsIiQkcm91dGUiLCJtYWluQ29udHJvbGxlciIsIiRtZFNpZGVuYXYiLCJjbG9zZU1lbnUiLCJjbG9zZSIsInRvZ2dsZU1lbnUiLCJ0b2dnbGUiLCJ1cmwiLCJtZW51IiwibWFpbiIsImljb24iLCJtZW51VGV4dCIsImRlcHMiLCJydW4iXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEdBTUEsUUFBQUMsR0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxjQUNBQyxXQUFBLHNCQUNBQyxhQUFBLE9BQ0FDLFlBQUEsaUNBRUFILEtBQUEsb0JBQ0FDLFdBQUEsc0JBQ0FDLGFBQUEsT0FDQUMsWUFBQSw2QkFkQU4sRUFBQU8sT0FBQSxpQkFBQSxZQUNBQyxPQUFBUCxHQUVBQSxFQUFBUSxTQUFBLG1CQWVBQyxPQUFBVixTQ25CQSxTQUFBQSxHQU1BLFFBQUFDLEdBQUFDLEdBRUFBLEVBQ0FDLEtBQUEsWUFDQUMsV0FBQSxtQkFDQUMsYUFBQSxPQUNBQyxZQUFBLHVCQUNBSyxNQUFBLFlBWEFYLEVBQUFPLE9BQUEsZUFBQSxZQUNBQyxPQUFBUCxHQUVBQSxFQUFBUSxTQUFBLG1CQWFBQyxPQUFBVixTQ2xCQSxTQUFBQSxHQUNBQSxFQUFBTyxPQUFBLGdCQUFBLFlBQ0FDLFFBQUEsaUJBQUEsU0FBQU4sR0FFQUEsRUFDQUMsS0FBQSxhQUNBQyxXQUFBLHFCQUNBQyxhQUFBLE9BQ0FDLFlBQUEseUJBQ0FLLE1BQUEsc0JBR0FELE9BQUFWLFNDYkEsU0FBQUEsR0FVQSxRQUFBWSxHQUFBQyxFQUFBQyxHQU9BLFFBQUFDLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUosRUFBQUssT0FvQkEsT0FsQkFKLEdBQUFLLGVBQUFDLEtBQUEsU0FBQUMsR0FFQSxHQUFBQyxH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QUEsaUJBQUE0SSxHQUVBUCxFQUFBaEksU0FBQSxjQ2JBdUksRUFBQXZJLFNBQUEsU0FBQSxhQUFBLGNFREFDLE9BQUFWIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbihhbmd1bGFyKXtcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmV0aXF1ZXRhcycsWyduZ1JvdXRlJ10pXG4gIC5jb25maWcoY29uZmlnRm4pO1xuXG4gIGNvbmZpZ0ZuLiRpbmplY3QgPSBbJyRyb3V0ZVByb3ZpZGVyJ107XG4gIGZ1bmN0aW9uIGNvbmZpZ0ZuKCRyb3V0ZVByb3ZpZGVyKXtcbiAgICAkcm91dGVQcm92aWRlclxuICAgIC53aGVuKCcvZXRpcXVldGFzJyx7XG4gICAgICBjb250cm9sbGVyOidldGlxdWV0YXNDb250cm9sbGVyJyxcbiAgICAgIGNvbnRyb2xsZXJBczonY3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDonZXRpcXVldGFzL2Nob29zZV9pZGlvbWEuaHRtbCdcbiAgICB9KVxuICAgIC53aGVuKCcvZXRpcXVldGFzLzpsYW5nJyx7XG4gICAgICBjb250cm9sbGVyOidldGlxdWV0YXNDb250cm9sbGVyJyxcbiAgICAgIGNvbnRyb2xsZXJBczonY3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDonZXRpcXVldGFzL2V0aXF1ZXRhcy5odG1sJ1xuICAgIH0pO1xuICB9XG5cbn0pKHdpbmRvdy5hbmd1bGFyKTtcbiIsIlxuKGZ1bmN0aW9uKGFuZ3VsYXIpe1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaWRpb21hcycsWyduZ1JvdXRlJ10pXG4gIC5jb25maWcoY29uZmlnRm4pO1xuXG5jb25maWdGbi4kaW5qZWN0ID0gWyckcm91dGVQcm92aWRlciddO1xuZnVuY3Rpb24gY29uZmlnRm4oJHJvdXRlUHJvdmlkZXIpe1xuXG4gICRyb3V0ZVByb3ZpZGVyXG4gIC53aGVuKCcvaWRpb21hcycse1xuICAgIGNvbnRyb2xsZXI6J2lkaW9tYUNvbnRyb2xsZXInLFxuICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgIHRlbXBsYXRlVXJsOidpZGlvbWFzL2lkaW9tYXMuaHRtbCcsXG4gICAgdGl0bGU6J0lkaW9tYXMnXG4gIH0pO1xufVxuXG5cbn0pKHdpbmRvdy5hbmd1bGFyKTtcbiIsIlxuKGZ1bmN0aW9uKGFuZ3VsYXIpe1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLnNldHRpbmdzJyxbJ25nUm91dGUnXSlcbiAgLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpe1xuICBcbiAgICAkcm91dGVQcm92aWRlclxuICAgIC53aGVuKCcvc2V0dGluZ3MnLCB7XG4gICAgICBjb250cm9sbGVyOidzZXR0aW5nc0NvbnRyb2xsZXInLFxuICAgICAgY29udHJvbGxlckFzOiAnY3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDonc2V0dGluZ3Mvc2V0dGluZ3MuaHRtbCcsXG4gICAgICB0aXRsZTonQ29uZmlndXJhY2nDs24nXG4gICAgfSk7XG4gIH1dKTtcbn0pKHdpbmRvdy5hbmd1bGFyKTtcbiIsIihmdW5jdGlvbihhbmd1bGFyKXtcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmV0aXF1ZXRhcycpXG4gIC5zZXJ2aWNlKCdldGlxdWV0YXNTZXJ2aWNlJywgZXRpcXVldGFzU2VydmljZSk7XG5cblxuICB2YXIgZnMgPSByZXF1aXJlKCdmcycpO1xuICB2YXIgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcblxuICBldGlxdWV0YXNTZXJ2aWNlLiRpbmplY3QgPSBbJyRxJywnY29uZmlnU2VydmljZSddO1xuICBmdW5jdGlvbiBldGlxdWV0YXNTZXJ2aWNlKCRxLCBjb25maWdTZXJ2aWNlKXtcblxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGdldExhbmdUYWdzOiBnZXRMYW5nVGFnc1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnZXRMYW5nVGFncyhpZCl7XG4gICAgICB2YXIgZGVmZXJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAvL3JlYWQgbGFuZyBzZXR0aWduc1xuICAgICAgY29uZmlnU2VydmljZS5yZWFkU2V0dGluZ3MoKS50aGVuKGZ1bmN0aW9uKHNldHRpbmdzKXtcbiAgICAgICAgLy9wYXRoIHRvIGxhbmcuanNvbiBvZiB0aGUgZ2l2ZW4gbGFuZ1xuICAgICAgICB2YXIgbGFuZ0ZpbGUgPSBwYXRoLmpvaW4oc2V0dGluZ3MubG9jYWxMYW5nLCBpZCwnbGFuZy5qc29uJyk7XG4gICAgICAgIC8vcmVhZCBsYW5nLmpzb25cbiAgICAgICAgZnMucmVhZEZpbGUobGFuZ0ZpbGUsICd1dGY4JywgZnVuY3Rpb24oZXJyLCBjb250ZW50KXtcbiAgICAgICAgICBpZihlcnIpIGRlZmVyZWQucmVqZWN0KGVycik7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vcGFyc2UgZmlsZSBjb250ZW50IHRvIGpzb24gZm9yIHJlc29sdmUgcHJvbWlzZVxuICAgICAgICAgICAgdmFyIGxhbmdKc29uID0gSlNPTi5wYXJzZShjb250ZW50LnRyaW0oKSk7XG4gICAgICAgICAgICAvL3Jlc29sdmUgcHJvbWlzZVxuICAgICAgICAgICAgZGVmZXJlZC5yZXNvbHZlKGxhbmdKc29uKTtcblxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vaWYgZXJyb3Igb2NjdXJlZCB0aGVuIHJlamVjdCBwcm9taXNlIHdpdGggdGhlIGVyciBvYmplY3RcbiAgICAgICAgICAgIGRlZmVyZWQucmVqZWN0KGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZWZlcmVkLnByb21pc2U7XG4gICAgfVxuXG5cbiAgfVxuXG59KSh3aW5kb3cuYW5ndWxhcik7XG4iLCIgIC8qanNoaW50IGVzdmVyc2lvbjogNiAqL1xuKGZ1bmN0aW9uKGFuZ3VsYXIpe1xuXG4gIHZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG4gIHZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuICBjb25zdCBsYW5ndWFnZXNGaWxlID0gJ2xhbmd1YWdlcy5qc29uJztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmlkaW9tYXMnKVxuICAuc2VydmljZSgnaWRpb21hc1NlcnZpY2UnLCBpZGlvbWFzU2VydmljZSk7XG5cbiAgaWRpb21hc1NlcnZpY2UuJGluamVjdCA9IFsnY29uZmlnU2VydmljZScsICckcSddO1xuICBmdW5jdGlvbiBpZGlvbWFzU2VydmljZShjb25maWdTZXJ2aWNlLCAkcSl7XG4gICAgcmV0dXJuIHtcbiAgICAgIGdldEluc3RhbGVkTGFuZ3VhZ2VzOiBnZXRJbnN0YWxlZExhbmd1YWdlcyxcbiAgICAgIHNhdmVMYW5ndWFnZTogc2F2ZUxhbmd1YWdlLFxuICAgICAgZGVsZXRlTGFuZ3VhZ2U6IGRlbGV0ZUxhbmd1YWdlXG4gICAgfTtcblxuXG4gICAgZnVuY3Rpb24gZ2V0SW5zdGFsZWRMYW5ndWFnZXMoKXtcbiAgICAgIHZhciBkZWZlcmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgY29uZmlnU2VydmljZS5yZWFkU2V0dGluZ3MoKS50aGVuKGZ1bmN0aW9uKHNldHRpbmdzKXtcblxuICAgICAgICB2YXIgbG9jYWxGaWxlID0gcGF0aC5qb2luKHNldHRpbmdzLmxvY2FsTGFuZywgbGFuZ3VhZ2VzRmlsZSk7XG4gICAgICAgIC8vdmFyIHJlbW90ZUZpbGUgPSBwYXRoLmpvaW4oc2V0dGluZ3MucmVtb3RlTGFuZywgbGFuZ3VhZ2VzKTtcblxuICAgICAgICAvL3JlYWRpbmcgZmlsZSB0byBnZXQgbGFuZ3VhZ2VzXG4gICAgICAgIGZzLnJlYWRGaWxlKGxvY2FsRmlsZSwndXRmOCcsZnVuY3Rpb24oZXJyLCBkYXRhKXtcbiAgICAgICAgICBpZihlcnIpZGVmZXJlZC5yZWplY3QoZXJyKTtcbiAgICAgICAgICB0cnl7XG4gICAgICAgICAgICB2YXIgbGFuZyA9IEpTT04ucGFyc2UoZGF0YS50cmltKCkpO1xuICAgICAgICAgICAgZGVmZXJlZC5yZXNvbHZlKGxhbmcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXRjaChlKXtcbiAgICAgICAgICAgIGRlZmVyZWQucmVqZWN0KGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZWZlcmVkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZUxhbmd1YWdlKGxhbmcpe1xuICAgICAgdmFyIGRlZmVyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgY29uZmlnU2VydmljZS5yZWFkU2V0dGluZ3MoKS50aGVuKGZ1bmN0aW9uKHNldHRpbmdzKXtcbiAgICAgICAgLy9wYXRoIHRvIGxvY2FsIGxhbmd1YWdlcyBmaWxlXG4gICAgICAgIHZhciBsb2NhbEZpbGUgPSBwYXRoLmpvaW4oc2V0dGluZ3MubG9jYWxMYW5nLCBsYW5ndWFnZXNGaWxlKTtcbiAgICAgICAgLy9wYXRoIHRvIGxvY2FsIGxvY2FsIGlkIGxhbmcgZGlyZWN0b3J5XG4gICAgICAgIHZhciBsYW5nRm9sZGVyID0gcGF0aC5qb2luKHNldHRpbmdzLmxvY2FsTGFuZywgbGFuZy5pZCk7XG4gICAgICAgIC8vcGF0aCB0byBuZXcgbGFuZy5qc29uIGZpbGVcbiAgICAgICAgdmFyIG5ld0xhbmdGaWxlID0gcGF0aC5qb2luKGxhbmdGb2xkZXIsICdsYW5nLmpzb24nKTtcblxuICAgICAgICAvL3JlYWRpbmcgaW5zdGFsbGVkIGxhbmd1YWdlc1xuICAgICAgICBnZXRJbnN0YWxlZExhbmd1YWdlcygpLnRoZW4oZnVuY3Rpb24obGFuZ3VhZ2VzKXtcbiAgICAgICAgICAvL3ZlcmlmeSBpZiB0aGUgbmV3IHNhdmVkIGxhbmd1YWdlcyBleGlzdHNcbiAgICAgICAgICBpZighX19sYW5nRXhpc3RzKGxhbmd1YWdlcywgbGFuZy5pZCkpe1xuICAgICAgICAgICAgLy9pZiBub3QgZXhpc3RzIGNyZWF0ZSBsYW5nRm9sZGVyIGRpcmVjdG9yeVxuICAgICAgICAgICAgZnMubWtkaXIobGFuZ0ZvbGRlciwgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgaWYoZXJyKSBkZWZlcmVkLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAvL2NyZWF0ZSBuZXcgbGFuZy5qc29uIGZpbGVcbiAgICAgICAgICAgICAgZnMud3JpdGVGaWxlKG5ld0xhbmdGaWxlLCAne30nLCd1dGY4JywgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICBpZihlcnIpZGVmZXJlZC5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAvL3VwZGF0ZSBsYW5ndWFnZXNcbiAgICAgICAgICAgICAgICBsYW5ndWFnZXMucHVzaChsYW5nKTtcbiAgICAgICAgICAgICAgICAvL2dldCBsYW5ndWFnZXMganNvbiBzdHJpbmdcbiAgICAgICAgICAgICAgICB2YXIgbGFuZ3VhZ2VzU3RyID0gSlNPTi5zdHJpbmdpZnkobGFuZ3VhZ2VzKTtcbiAgICAgICAgICAgICAgICAvL3dyaXRlIHRoZSBuZXcgbGFuZ3VhZ2VzIGZpbGVcbiAgICAgICAgICAgICAgICBmcy53cml0ZUZpbGUobG9jYWxGaWxlLGxhbmd1YWdlc1N0ciwndXRmOCcsIGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgICBpZihlcnIpZGVmZXJlZC5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgIGRlZmVyZWQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIC8vcmVqZWN0IHRoZSBkZWZlcmVkIGlmIHRoZSBzdXBwbGllZCBsYW5ndWFnZXMgZXhpc3RzXG4gICAgICAgICAgICBkZWZlcmVkLnJlamVjdCh7Y29kZTogJ0VYVExBTkcnLCBkZXNjcmlwdGlvbjogJ0VzdGUgaWRpb21hIHlhIGV4aXN0ZSd9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGVmZXJlZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZUxhbmd1YWdlKGxhbmcpe1xuICAgICAgdmFyIGRlZmVyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICBjb25maWdTZXJ2aWNlLnJlYWRTZXR0aW5ncygpLnRoZW4oZnVuY3Rpb24oc2V0dGluZ3Mpe1xuICAgICAgICAvL3BhdGggdG8gbG9jYWwgbGFuZ3VhZ2VzIGZpbGVcbiAgICAgICAgdmFyIGxvY2FsRmlsZSA9IHBhdGguam9pbihzZXR0aW5ncy5sb2NhbExhbmcsIGxhbmd1YWdlc0ZpbGUpO1xuICAgICAgICAvL3BhdGggdG8gbG9jYWwgbGFuZyBpZCBkaXJlY3RvcnlcbiAgICAgICAgdmFyIGxhbmdGb2xkZXIgPSBwYXRoLmpvaW4oc2V0dGluZ3MubG9jYWxMYW5nLCBsYW5nLmlkKTtcblxuICAgICAgICAvL3JlYWQgaW5zdGFsbGVkIGxhbmd1YWdlc1xuICAgICAgICBnZXRJbnN0YWxlZExhbmd1YWdlcygpLnRoZW4oZnVuY3Rpb24obGFuZ3VhZ2VzKXtcbiAgICAgICAgICB2YXIgbmV3TGFuZ3VhZ2VzID0gX19yZW1vdmVsYW5ndWFnZShsYW5ndWFnZXMsIGxhbmcuaWQpO1xuXG4gICAgICAgICAgLy9yZW1vdmUgYWxsIGZpbGVzIGluIHRoZSBsYW5nIGRpcmVjdG9yeVxuICAgICAgICAgIGZzLnJlYWRkaXIobGFuZ0ZvbGRlciwgZnVuY3Rpb24oZXJyLCBmaWxlcyl7XG4gICAgICAgICAgICBpZihlcnIpZGVmZXJlZC5yZWplY3QoZXJyKTtcblxuICAgICAgICAgICAgZmlsZXMuZm9yRWFjaChmdW5jdGlvbihmaWxlKXtcbiAgICAgICAgICAgICAgdmFyIGZpbGVUb0RlbGV0ZSA9IHBhdGguam9pbihsYW5nRm9sZGVyLCBmaWxlKTtcbiAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlVG9EZWxldGUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vcmVtb3ZlIHRoZSBsYW5nIGRpcmVjdG9yeVxuICAgICAgICAgICAgZnMucm1kaXIobGFuZ0ZvbGRlciwgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgaWYoZXJyKSBkZWZlcmVkLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICB2YXIganNvbkxhbmd1YWdlcyA9IEpTT04uc3RyaW5naWZ5KG5ld0xhbmd1YWdlcyk7XG4gICAgICAgICAgICAgIC8vd3JpdGluZyBuZXcganNvbiBsYW5ndWFnZXMgYWZ0ZXIgZGVsZXRlXG4gICAgICAgICAgICAgIGZzLndyaXRlRmlsZShsb2NhbEZpbGUsanNvbkxhbmd1YWdlcywndXRmOCcsIGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgaWYoZXJyKWRlZmVyZWQucmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgLy9pZiBldmVyeXRoaW5nIG9rLCB0aGVuIHJlc29sdmUgZGVmZXJlZFxuICAgICAgICAgICAgICAgIGRlZmVyZWQucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcblxuXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGVmZXJlZC5wcm9taXNlO1xuICAgIH1cblxuXG4vL1ByaXZhdGVzIGZ1bmN0aW9uc1xuICAgIGZ1bmN0aW9uIF9fbGFuZ0V4aXN0cyhsYW5nLCBpZCl7XG5cbiAgICAgIGlmKGxhbmcgaW5zdGFuY2VvZiBBcnJheSl7XG4gICAgICAgIHZhciBlbGVtZW50ID0gbGFuZy5maWx0ZXIoZnVuY3Rpb24oZSl7XG4gICAgICAgICAgcmV0dXJuIGUuaWQgPT0gaWQ7XG4gICAgICAgIH0pO1xuICAgICAgICBpZihlbGVtZW50Lmxlbmd0aCA+IDApe1xuICAgICAgICAgIC8vZXhpc3RlXG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgJ25vdCBhbiBhcnJheSc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX19yZW1vdmVsYW5ndWFnZShsYW5ndWFnZXMsIGlkKXtcbiAgICAgIC8vcmV0dXJuIGVsZW1lbnRzIG9mIHRoZSBhcnJheSBkaWZmZXRlbnQgb2Ygc3VwcGxpZWQgaWRcbiAgICAgIHJldHVybiBsYW5ndWFnZXMuZmlsdGVyKGZ1bmN0aW9uKGUpe1xuICAgICAgICByZXR1cm4gZS5pZCAhPSBpZDtcbiAgICAgIH0pO1xuICAgIH1cblxuICB9XG5cbn0pKHdpbmRvdy5hbmd1bGFyKTtcbiIsIihmdW5jdGlvbihhbmd1bGFyKXtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcbiAgdmFyIGNvbmZpZ0ZpbGUgPSAnLi9jb25maWcuanNvbic7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5jb25maWcnLFtdKVxuICAuc2VydmljZSgnY29uZmlnU2VydmljZScsIHNldHRpbmdzU2VydmljZSk7XG5cbiAgc2V0dGluZ3NTZXJ2aWNlLiRpbmplY3QgPSBbJyRxJ107XG4gIGZ1bmN0aW9uIHNldHRpbmdzU2VydmljZSgkcSl7XG5cbiAgICAgIGZ1bmN0aW9uIHNhdmVTZXR0aW5ncyhzZXR0aW5ncyl7XG4gICAgICAgIHZhciBkZWZlcmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICBmcy53cml0ZUZpbGUoY29uZmlnRmlsZSwgSlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpLCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgIGlmKGVycikgZGVmZXJlZC5yZWplY3QoZXJyKTtcbiAgICAgICAgICBkZWZlcmVkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGVmZXJlZC5wcm9taXNlO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZWFkU2V0dGluZ3MoKXtcbiAgICAgICAgdmFyIGRlZmVyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIGZzLmV4aXN0cyhjb25maWdGaWxlLCBmdW5jdGlvbihleGlzdHMpe1xuICAgICAgICAgIGlmKGV4aXN0cyl7XG4gICAgICAgICAgICBmcy5yZWFkRmlsZShjb25maWdGaWxlLCd1dGY4JywgZnVuY3Rpb24oZXJyLCBkYXRhKXtcbiAgICAgICAgICAgICAgaWYoZXJyKSBkZWZlcmVkLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICBkZWZlcmVkLnJlc29sdmUoSlNPTi5wYXJzZShkYXRhLnRyaW0oKSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY3JlYXRlQ29uZmlnKCkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgICByZXR1cm4gcmVhZFNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGVmZXJlZC5wcm9taXNlO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBjcmVhdGVDb25maWcoKXtcbiAgICAgICAgdmFyIGRlZmVyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICBmcy53cml0ZUZpbGUoY29uZmlnRmlsZSwne30nLCd1dGY4JywgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICBpZihlcnIpIGRlZmVyZWQucmVqZWN0KGVycik7XG4gICAgICAgICAgZGVmZXJlZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRlZmVyZWQucHJvbWlzZTtcbiAgICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzYXZlU2V0dGluZ3M6IHNhdmVTZXR0aW5ncyxcbiAgICAgIHJlYWRTZXR0aW5nczogcmVhZFNldHRpbmdzXG4gICAgfTtcbiAgfVxuXG59KSh3aW5kb3cuYW5ndWxhcik7XG4iLCIoZnVuY3Rpb24oYW5ndWxhcil7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC51dGlscycsW10pXG4gIC5zZXJ2aWNlKCd1dGlsc1NlcnZpY2UnLCB1dGlsc1NlcnZpY2UpO1xuXG4gIHV0aWxzU2VydmljZS4kaW5qZWN0ID0gWyckbWREaWFsb2cnXTtcbiAgZnVuY3Rpb24gdXRpbHNTZXJ2aWNlKCRtZERpYWxvZyl7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFsZXJ0OiBhbGVydFxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBhbGVydChtc2cpe1xuXG4gICAgfVxuICAgIGZ1bmN0aW9uIGNyZWF0ZUFsZXJ0KCRldmVudCxtc2csdGl0bGUsIHR5cGUpe1xuICAgICAgdHlwZSA9IHR5cGUgfHwgJ2FsZXJ0JztcbiAgICAgIHRpdGxlID0gdGl0bGUgfHwgJ0FsZXJ0JztcbiAgICAgIHZhciBtZEFsZXJ0O1xuXG4gICAgICBpZih0eXBlID09ICdhbGVydCcpe1xuICAgICAgICBtZEFsZXJ0ID0gJG1kRGlhbG9nLmFsZXJ0KCk7XG4gICAgICB9IGVsc2UgaWYodHlwZSA9PSAnZXJyb3InKXtcbiAgICAgICAgbWRBbGVydCA9ICRtZERpYWxvZy5hbGVydCgpO1xuICAgICAgfSBlbHNlIGlmKHR5cGUgPT0gJ2NvbmZpcm0nKXtcbiAgICAgICAgbWRBbGVydCA9ICRtZERpYWxvZy5jb25maXJtKCk7XG5cbiAgICAgICAgbWRBbGVydC5jbGlja091dHNpZGVUb0Nsb3NlKHRydWUpXG4gICAgICAgIC50aXRsZSh0aXRsZSlcbiAgICAgICAgLnRleHRDb250ZW50KG1zZylcbiAgICAgICAgLm9rKCdTaScpXG4gICAgICAgIC5jYW5jZWwoJ05vJylcbiAgICAgICAgLnRhcmdldEV2ZW50KCRldmVudCk7XG5cbiAgICAgICAgcmV0dXJuICRtZERpYWxvZy5zaG93KG1kQWxlcnQpO1xuICAgICAgfVxuXG4gICAgICBtZEFsZXJ0LmNsaWNrT3V0c2lkZVRvQ2xvc2UodHJ1ZSlcbiAgICAgIC50aXRsZSh0aXRsZSlcbiAgICAgIC50ZXh0Q29udGVudChtc2cpXG4gICAgICAudGFyZ2V0RXZlbnQoJGV2ZW50KTtcblxuICAgICAgJG1kRGlhbG9nLnNob3cobWRBbGVydCk7XG4gICAgfVxuICB9XG5cbn0pKHdpbmRvdy5hbmd1bGFyKTtcbiIsIlxuKGZ1bmN0aW9uKGFuZ3VsYXIpe1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgZnMgPSByZXF1aXJlKCdmcycpO1xuICB2YXIgY29uZmlnRmlsZSA9ICcuL2NvbmZpZy5qc29uJztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLnNldHRpbmdzJylcbiAgLnNlcnZpY2UoJ3NldHRpbmdzU2VydmljZScsIHNldHRpbmdzU2VydmljZSk7XG5cbiAgc2V0dGluZ3NTZXJ2aWNlLiRpbmplY3QgPSBbJ2NvbmZpZ1NlcnZpY2UnXTtcbiAgZnVuY3Rpb24gc2V0dGluZ3NTZXJ2aWNlKGNvbmZpZ1NlcnZpY2Upe1xuXG4gICAgICBmdW5jdGlvbiBzYXZlU2V0dGluZ3Moc2V0dGluZ3Mpe1xuICAgICAgICByZXR1cm4gY29uZmlnU2VydmljZS5zYXZlU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZWFkU2V0dGluZ3MoKXtcbiAgICAgICAgcmV0dXJuIGNvbmZpZ1NlcnZpY2UucmVhZFNldHRpbmdzKCk7XG4gICAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc2F2ZVNldHRpbmdzOiBzYXZlU2V0dGluZ3MsXG4gICAgICByZWFkU2V0dGluZ3M6IHJlYWRTZXR0aW5nc1xuICAgIH07XG4gIH1cblxuXG59KSh3aW5kb3cuYW5ndWxhcik7XG4iLCIoZnVuY3Rpb24oYW5ndWxhcil7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ldGlxdWV0YXMnKVxuICAuY29udHJvbGxlcignZXRpcXVldGFzQ29udHJvbGxlcicsIGV0aXF1ZXRhc0NvbnRyb2xsZXIpO1xuXG4gIGV0aXF1ZXRhc0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICckbG9jYXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lkaW9tYXNTZXJ2aWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICckcm91dGVQYXJhbXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V0aXF1ZXRhc1NlcnZpY2UnXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gIGZ1bmN0aW9uIGV0aXF1ZXRhc0NvbnRyb2xsZXIoJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZGlvbWFzU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm91dGVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXRpcXVldGFzU2VydmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYub3BlbiA9IG9wZW5FdGlxdWV0YXM7XG5cbiAgICBpZiAoISRyb3V0ZVBhcmFtcy5sYW5nKSB7XG4gICAgXHRpZGlvbWFzU2VydmljZS5nZXRJbnN0YWxlZExhbmd1YWdlcygpLnRoZW4oZnVuY3Rpb24oaWRpb21hcykge1xuICAgIFx0XHRzZWxmLmlkaW9tYXMgPSBpZGlvbWFzO1xuICAgIFx0fSk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgZ2V0TGFuZ1RhZ3MoJHJvdXRlUGFyYW1zLmxhbmcpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9wZW5FdGlxdWV0YXMobGFuZyl7XG4gICAgICBjb25zb2xlLmxvZyhsYW5nKTtcbiAgICAgICRsb2NhdGlvbi5wYXRoKCcvZXRpcXVldGFzLycgKyBsYW5nLmlkKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRMYW5nVGFncyhsYW5nSWQpe1xuICAgICAgZXRpcXVldGFzU2VydmljZS5nZXRMYW5nVGFncyhsYW5nSWQpLnRoZW4oZnVuY3Rpb24odGFncyl7XG4gICAgICAgIHNlbGYudGFncyA9IHRhZ3M7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxufSkod2luZG93LmFuZ3VsYXIpO1xuIiwiLypqc2hpbnQgZXN2ZXJzaW9uOiA2Ki9cbihmdW5jdGlvbihhbmd1bGFyKSB7XG5cblx0YW5ndWxhci5tb2R1bGUoJ2FwcC5pZGlvbWFzJylcblx0XHQuY29udHJvbGxlcignaWRpb21hQ29udHJvbGxlcicsIGlkaW9tYUNvbnRyb2xsZXIpO1xuXG5cdGlkaW9tYUNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRtZERpYWxvZycsJyR0aW1lb3V0JywnaWRpb21hc1NlcnZpY2UnXTtcblxuXHRmdW5jdGlvbiBpZGlvbWFDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCR0aW1lb3V0LGlkaW9tYXNTZXJ2aWNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHNlbGYub3BlbkFkZElkaW9tYSA9IG9wZW5BZGRJZGlvbWE7XG5cdFx0c2VsZi5nZXRJbnN0YWxlZExhbmd1YWdlcyA9IGdldEluc3RhbGVkTGFuZ3VhZ2VzO1xuXHRcdHNlbGYuZGVsZXRlID0gZGVsZXRlTGFuZ3VhZ2U7XG5cblx0XHRzZWxmLmdldEluc3RhbGVkTGFuZ3VhZ2VzKCk7XG5cblxuXHRcdGZ1bmN0aW9uIGdldEluc3RhbGVkTGFuZ3VhZ2VzKCl7XG5cdFx0XHRpZGlvbWFzU2VydmljZS5nZXRJbnN0YWxlZExhbmd1YWdlcygpLnRoZW4oZnVuY3Rpb24obGFuZyl7XG5cdFx0XHRcdCRzY29wZS5pZGlvbWFzID0gW10uY29uY2F0KGxhbmcpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gb3BlbkFkZElkaW9tYShldikge1xuXHRcdFx0c2VsZi5pZGlvbWEgPSB7fTtcblx0XHRcdCRtZERpYWxvZy5zaG93KHtcblx0XHRcdFx0dGl0bGU6ICdBZ3JlZ2FyIElkaW9tYScsXG5cdFx0XHRcdGNvbnRyb2xsZXI6IGRpYWxvZ0NvbnRyb2xsZXIsXG5cdFx0XHRcdGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuXHRcdFx0XHR0ZW1wbGF0ZVVybDogJ2lkaW9tYXMvYWRkLWlkaW9tYS5odG1sJyxcblx0XHRcdFx0cGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG5cdFx0XHRcdHRhcmdldEV2ZW50OiBldixcblx0XHRcdFx0Y2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZGVsZXRlTGFuZ3VhZ2UoJGV2ZW50LCBsYW5nKXtcblxuXG5cdFx0XHR2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcblx0XHRcdFx0LnRpdGxlKCdEZXNlYSBFbGltaW5hciBlbCBpZGlvbWEgc2VsZWNjaW9uYWRvPycpXG5cdFx0XHRcdC50ZXh0Q29udGVudCgnRXN0ZSBwcm9jZXNvIGVsaW1pbmFyYSBlbCBpZGlvbWEgc2VsZWNjaW9uYWRvIGFzaSBjb21vIGN1YWxxdWllciBldGlxdWV0YSBjcmVhZGEnKVxuXHRcdFx0XHQub2soJ0VsaW1pbmFyJylcblx0XHRcdFx0LnBhcmVudChhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkpXG5cdFx0XHRcdC5hcmlhTGFiZWwoJ2NvbmZpcm1hdGlvbicpXG5cdFx0XHRcdC5jYW5jZWwoJ0NhbmNlbGFyJylcblx0XHRcdFx0LnRhcmdldEV2ZW50KCRldmVudCk7XG5cblx0XHRcdFx0ZnVuY3Rpb24gaWZZZXMoKXtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIHN1Y2Nlc3MoKXtcblx0XHRcdFx0XHRcdHZhciBhbGVydCA9ICRtZERpYWxvZy5hbGVydCgpXG5cdFx0XHRcdFx0XHRcdC50aXRsZSgnUHJvY2VzbyBDb21wbGV0YWRvJylcblx0XHRcdFx0XHRcdFx0LnRleHRDb250ZW50KCdFbCBpZGlvbWEgaGEgc2lkbyBlbGVtaW5hZG8gY29uIGV4aXRvIScpXG5cdFx0XHRcdFx0XHRcdC5wYXJlbnQoYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpKVxuXHRcdFx0XHRcdFx0XHQuYXJpYUxhYmVsKCdjb25maXJtYXRpb24nKVxuXHRcdFx0XHRcdFx0XHQub2soJ0FjZXB0YXInKVxuXHRcdFx0XHRcdFx0XHQudGFyZ2V0RXZlbnQoJGV2ZW50KTtcblxuXHRcdFx0XHRcdFx0XHRzZWxmLmdldEluc3RhbGVkTGFuZ3VhZ2VzKCk7XG5cblx0XHRcdFx0XHRcdFx0JG1kRGlhbG9nLnNob3coYWxlcnQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRmdW5jdGlvbiBlcnJvcihlcnIpe1xuXHRcdFx0XHRcdFx0dmFyIGVycm9yID0gJG1kRGlhbG9nLmFsZXJ0KClcblx0XHRcdFx0XHRcdFx0LnRpdGxlKCdBbGdvIG5vIGFuZGEgYmllbicpXG5cdFx0XHRcdFx0XHRcdC50ZXh0Q29udGVudChcIkh1Ym8gdW4gZXJyb3IgZWxpbWluYW5kbyBlbCBpZGlvbWEgc2VsZWNjaW9uYWRvLCBcIiArIGVycilcblx0XHRcdFx0XHRcdFx0LnBhcmVudChhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkpXG5cdFx0XHRcdFx0XHRcdC5hcmlhTGFiZWwoJ2NvbmZpcm1hdGlvbicpXG5cdFx0XHRcdFx0XHRcdC5vaygnQWNlcHRhcicpXG5cdFx0XHRcdFx0XHRcdC50YXJnZXRFdmVudCgkZXZlbnQpO1xuXG5cdFx0XHRcdFx0XHRcdCRtZERpYWxvZy5zaG93KGVycm9yKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZGlvbWFzU2VydmljZS5kZWxldGVMYW5ndWFnZShsYW5nKS50aGVuKHN1Y2Nlc3MsZXJyb3IpO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHQkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGlmWWVzKTtcblxuXG5cblxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGRpYWxvZ0NvbnRyb2xsZXIoKXtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0c2VsZi5hZGRJZGlvbWEgPSBhZGRJZGlvbWE7XG5cdFx0XHRzZWxmLmNsb3NlQWRkRGlhbG9nID0gY2xvc2VBZGREaWFsb2c7XG5cblxuXG5cdFx0XHRmdW5jdGlvbiBhZGRJZGlvbWEoY3RybCkge1xuXG5cdFx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHNlbGYpO1xuXHRcdFx0XHRcdHZhciBsYW5nID0ge2lkOiBzZWxmLmlkaW9tYS5pZC50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0XHRcdFx0ZGVzY3JpcHRpb246IHNlbGYuaWRpb21hLmRlc2NyaXB0aW9uLnRvVXBwZXJDYXNlKClcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0aWRpb21hc1NlcnZpY2Uuc2F2ZUxhbmd1YWdlKGxhbmcpLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gc3VjY2VzcyhyZXN1bHQpe1xuXHRcdFx0XHRcdFx0aWRpb21hc1NlcnZpY2UuZ2V0SW5zdGFsZWRMYW5ndWFnZXMoKS50aGVuKGZ1bmN0aW9uKGxhbmcpe1xuXHRcdFx0XHRcdFx0XHQkc2NvcGUuaWRpb21hcyA9IFtdLmNvbmNhdChsYW5nKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0Y2xvc2VBZGREaWFsb2coKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZnVuY3Rpb24gZXJyb3IocmVzdWx0KXtcblx0XHRcdFx0XHRcdHNlbGYuaWRpb21hLmVycm9yID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cblxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gY2xvc2VBZGREaWFsb2coKSB7XG5cdFx0XHRcdCRtZERpYWxvZy5jYW5jZWwoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn0pKGFuZ3VsYXIpO1xuIiwiXG5cbihmdW5jdGlvbihhbmd1bGFyKXtcblxuYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXR0aW5ncycpXG4uY29udHJvbGxlcignc2V0dGluZ3NDb250cm9sbGVyJywgc2V0dGluZ3NDb250cm9sbGVyKTtcblxuc2V0dGluZ3NDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsJyR0aW1lb3V0Jywnc2V0dGluZ3NTZXJ2aWNlJywnJG1kRGlhbG9nJ107XG5mdW5jdGlvbiBzZXR0aW5nc0NvbnRyb2xsZXIoJHNjb3BlLCAkdGltZW91dCwgc2V0dGluZ3NTZXJ2aWNlLCAkbWREaWFsb2cpe1xuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgc2VsZi5mb3JtID0ge307XG4gIHNlbGYuY2hvb3NlTG9jYWxMYW5nID0gY2hvb3NlTG9jYWxMYW5nO1xuICBzZWxmLmNob29zZVJlbW90ZUxhbmcgPSBjaG9vc2VSZW1vdGVMYW5nO1xuICBzZWxmLnNhdmVTZXR0aW5ncyA9IHNhdmVTZXR0aW5ncztcbiAgc2VsZi5yZWFkU2V0dGluZ3MgPSByZWFkU2V0dGluZ3M7XG5cbiAgc2VsZi5yZWFkU2V0dGluZ3MoKTtcblxuICBmdW5jdGlvbiBzYXZlU2V0dGluZ3Moc2VuZGVyKXtcbiAgICBzZXR0aW5nc1NlcnZpY2Uuc2F2ZVNldHRpbmdzKHNlbGYuZm9ybSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgdmFyIGFsZXJ0ID0gJG1kRGlhbG9nLmFsZXJ0KCk7XG5cbiAgICAgIGFsZXJ0LnRleHRDb250ZW50KCdDYW1iaW9zIEd1YXJkYWRvcyBjb24gRXhpdG8hJylcbiAgICAgIC50aXRsZSgnQWxlcnRhIScpXG4gICAgICAudGFyZ2V0RXZlbnQoc2VuZGVyKVxuICAgICAgLm9rKCdBY2VwdGFyJyk7XG4gICAgICAkbWREaWFsb2cuc2hvdyhhbGVydCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiByZWFkU2V0dGluZ3MoKXtcbiAgICBzZXR0aW5nc1NlcnZpY2UucmVhZFNldHRpbmdzKCkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgc2VsZi5mb3JtID0gcmVzdWx0O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hvb3NlTG9jYWxMYW5nKCkge1xuICAgIG9wZW5EaWFsb2coZnVuY3Rpb24oZXZlbnQsIHBhdGgsIHByb2Mpe1xuICAgICAgc2VsZi5mb3JtLmxvY2FsTGFuZyA9IHBhdGhbMF07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBjaG9vc2VSZW1vdGVMYW5nKCkge1xuICAgIG9wZW5EaWFsb2coZnVuY3Rpb24oZXZlbnQsIHBhdGgsIHByb2Mpe1xuICAgICAgc2VsZi5mb3JtLnJlbW90ZUxhbmcgPSBwYXRoWzBdO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gb3BlbkRpYWxvZyhjYWxsYmFjayl7XG4gICAgdmFyIHByb2MgPSByZXF1aXJlKCdlbGVjdHJvbicpLmlwY1JlbmRlcmVyO1xuICAgIHByb2Muc2VuZCgnb3Blbi1maWxlLWRpYWxvZycpO1xuICAgIHByb2Mub25jZSgnc2VsZWN0ZWQtZGlyZWN0b3J5JywgZnVuY3Rpb24oZXZlbnQsIHBhdGgpe1xuICAgICAgJHRpbWVvdXQoY2FsbGJhY2soZXZlbnQsIHBhdGgpKTtcbiAgICB9KTtcbiAgfVxufVxuXG59KSh3aW5kb3cuYW5ndWxhcik7XG4iXX0=
